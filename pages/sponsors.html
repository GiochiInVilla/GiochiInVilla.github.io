<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="../../generalCSS/style.css">
	<link rel="stylesheet" href="../../generalCSS/button.css">
	<link rel="stylesheet" href="../../generalCSS/header.css">
	<link rel="stylesheet" href="../../fonts/fonts.css">
	<link rel="stylesheet" href="../../cards/cards.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	
</head>
<body>
	<!-- Overheader -->
	<div class="overheader"><div style="font-family: Avenge; letter-spacing: 1px; font-size: 30px;">Giochi in Villa</div></div>
	<br>

	<!-- Header -->
	<div class="header">
	  <img src="../images/technical/header.png" style="width: 90%; max-width: 1000px;"></img>
	</div>

	<div class="topnav">
	  <a href="../index.html">Home</a>
	  <a href="../pages/events.html">Eventi</a>
	  <a href="../pages/sponsors.html" style="float:right">Sponsors</a>
	</div>

	<div class="row">
		<!-- Left Column -->
		<div class="leftcolumn">
	 
			<div id="insertionPoint"></div>
			
			<p>
				Number: <span id="number">0</span><br>
				<a href="#" id="decreaseLink">Decrease</a>
				<a href="#" id="increaseLink">Increase</a>
			</p>
		
		<!-- End Left Column -->
		</div>
		
		<!-- Right Column -->
		<div class="rightcolumn">
			<div loadHTML="../cards/technical/presentation.html"></div>
			<div loadHTML="../cards/technical/socials.html"></div>
		</div>
	</div>

	<script type="text/javascript" src="../../HTMLloader.js"></script>
	
	<script>
        // Function to load HTML files based on the input number and insert them at a specific location
        function loadHTMLFiles(number, insertionPoint) {
            const container = document.createElement('div');
            
            for (let i = 1; i <= 3; i++) {
                const div = document.createElement('div');
                div.setAttribute('loadHTML', `../cards/articles/article${(number*3)+i}.html`);
                container.appendChild(div);
            }

            // Find the specific element with the provided ID
            const targetElement = document.getElementById(insertionPoint);
            if (targetElement) {
                targetElement.appendChild(container);
            }
        }

        // Get the input number from the URL
        const urlParams = new URLSearchParams(window.location.search);
        let number = parseInt(urlParams.get('number'));
		
		if (isNaN(number)) {
			number = 0;
		}

        loadHTMLFiles(number, 'insertionPoint');
    </script>
	
	<script>
		function loadEvents() {			
			includeHTML();
		}
		loadEvents();
	</script>
	
	
    <script>
        // Function to check if a file exists
        async function fileExists(filename) {
            try {
                await fetch(`../cards/articles/${filename}`);
                return true;
            } catch (error) {
                return false;
            }
        }

        // Function to update the number and enable/disable links
        async function updateNumberAndLinks(number) {
            const numberElement = document.getElementById('number');
            const decreaseLink = document.getElementById('decreaseLink');
            const increaseLink = document.getElementById('increaseLink');

            numberElement.textContent = number;
            decreaseLink.disabled = number === 0;

            const nextFileName = `article${number * 3 + 4}.html`;
			console.log('Filename:', nextFileName);
            const fileExistsNext = await fileExists(nextFileName);
            increaseLink.disabled = !fileExistsNext;
        }

        // Update the number and links
        updateNumberAndLinks(number);
		
        // Add event listeners to the links
        document.getElementById('decreaseLink').addEventListener('click', async (event) => {
            event.preventDefault();
            if (number > 0) {
                number--;
                await updateNumberAndLinks(number);
            }
        });

        document.getElementById('increaseLink').addEventListener('click', async (event) => {
            event.preventDefault();
            const nextFileName = `article${number * 3 + 4}.html`;
            const fileExistsNext = await fileExists(nextFileName);
            if (fileExistsNext) {
                number++;
                await updateNumberAndLinks(number);
            }
        });
    </script>
</body>
</html>